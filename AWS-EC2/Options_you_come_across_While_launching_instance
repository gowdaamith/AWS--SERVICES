sThe options you come across while launching an Instance:

1.Names and Tags
-----------------------------------------------
Name : This is only a label for identification .
       AWS stores it as  a key:value pair with Name as key and value as the instance  name 


Add Additional Tags : 
Tags : metadata attached to an instance 

Ex: 
*Environment: Dev/Test/Prod
*Owner =Amith
*Project = MicroServices

These Help in :  Biling ,Automation ,IAM permission, Organization 

2.Application and OS Images (Amazon Machine Image)
---------------------------------------------------
You can select a already existing AMI or create a new one :

AMI defines : 
*Operating system 
*Default user
*Preinstalled libraries
*Root volume type(EBS)
*Virtualization: HVM 

The AMI ID is specific to region 
If you change region -> AMI ID changes 

3.Instance types 
---------------------------------------------------
Instance type defines :
*CPU core
*RAM
*Network Bandwidth 
*EBS throughPut 
*Costs

4.Key Pair(Login)
----------------------------------------------------
This Key: 
*Contains private key (.pem) stored in your laptop 
*AWS  stores the public  key on the instance
*You ssh using:

>> ssh -i amithtest.pem ubuntu@public_ec2_ip

If you loose the ".pem" key you cannot SSH unless
*YOu use SSM session manager
*You attach  a new key manually 

5.Network Setting
---------------------------------------------------
VPC : You can choose the VPC of your choice or You can use the default VPC

It defines: 
*CIDR range 
*Subnets 
*Routing 
*Security 

Subnet: You  can create a subnet inside you VPC   and use it or If you choose a default you will use the default Subnet choosen by the AWS

Auto Assign Public IP: 
Enable 


This decides: 
| Setting | Meaning                               |
| ------- | ------------------------------------- |
| Enable  | Instance gets public IP → you can SSH |
| Disable | No public IP → Only private network   |

Best practice:
Public IP ONLY for bastion or NAT
Others → private only

6.Security Group (Acts as the firewall of the instances)
-------------------------------------------------------------
You can select the default one or create a new one and use it 

Security Group Control:
*Control Inbound
*Control Outbound
*Stateful -> reply traffic automatically allowed

7.Configure the Storage
--------------------------------------------------------------

You can select the amount of storage you want:
Important: 
This is the root volume ,meaning OS installed here 

Advanced Details:

1.Domain Join Directory :
  This setting allows your Ec2 instaces  to automatically join  a directory service when it boots

  If you don't have a one you can create one by following  the below steps:
  *Step 1: Click on the Create New Directory 
   Step 2: Select the directory types: - AWS managed MicroSoft AD  [With AWS Managed Microsoft AD, you can easily enable your Active Directory-aware workloads and AWS resources to use managed actual Microsoft Active Directory in the AWS Cloud. 
                                                                    Workload examples include Amazon EC2, Amazon RDS for SQL Server, custom .NET applications, and AWS Enterprise IT applications such as Amazon WorkSpaces.
                                       |_ AD connectors            [ AD  Connectors is a proxy for redirecting directory requests to your existing Microsoft Active Directory without caching any information in the cloud. 
                                                                     AD Connector comes in two sizes, small and large. A small AD Connector is designed for small organizations and is intended to handle a low number of operations per second.
                                                                     A large AD Connector is designed for large organizations and is intended to handle a moderate to high number of operations per second
  If you choose the  AD connector name:  
     Step 1: Directory size : AD connectors is available in the following two sizes ,small and large 
     Step 2: Choose the VPC and Subnet [The VPC contains your directory ]
     Step 3: Next specify the Active directory information 
     Step 4: Review and create


If you choose  AWS managed Microsoft AD 
     Step 1: Choose either  - Create a new AWS managed AD domain [ Create a fully-managed Microsoft AD in the AWS Cloud.
                            |                                       AWS Directory Service creates two domain controllers 
                            |                                       and adds the DNS service on your behalf.]
                            |_ Extend the existing AD domain with hybrid directory  [ Extend your self-managed AD domain into AWS, 
                                                                                       creating a single AD domain across cloud and your AD environments.]
  if you choose the  the second option : 
          Create directory assessment: 
          Specify : Self managed Active directory information  [ Enter the networking details to asseess your  self managed Active directory ]
                     Networking                         [ The VPC that contains your directory  ]
                     AWS system manager  managed nodes  [ Select 2 managed nodes representing  your self-managed AD domain controller for resiliency ]
         Review and Create the directory 

if you choose the  first option :
          Enter the directory information :
              Such as : 
                   Edition : Standard edition or Enterprise edition
                   Directory DNS name
                   Directory NetBIOS name - optional
                   Directory  description 
                   Admin password [ The password for the default administrative user named admin ]
                   Confirm password 
          Choose the VPC and the Subnet
           Review and create 

This allows for the centralized user management 
Group policies 
Login using Domain credentials 

2. IAM Instance Profile
------------------------------------------------
*Attaches an IAM role to the Ec2 instance 
*Which allows you Ec2 to access
 - S3
   Dynamo DB
   CloudWatch 
   SSM(AWS System Manager)
and the other services without needing access key 

3.Hostname type and DNS HostName type 
--------------------------------------------------
Will be managed by the AWS itself 
* AWS automatically generate the hostname -> ip-10-0-0-25.ec2.internal
* DNS hostname options :
     These checkboxes  control the DNS records(A/AAA) created for your Ec2
>> Enable IP name IPv4 (A record) DNS request  
   Instance -> IPv4 -> DNS name 
   10.0.1.25 → ip-10-0-1-25.ec2.internal
This is the default private DNS hostname
Nearly all Ec2 need this -> so it is on by default 

>> Enable resource-based IPv4 ( A record) DNS requests
   This means your Ec2 instances can also use resource-based names like:
   i-0abcd1234efgh5678.ec2.internal
So instead of the IP-based name ,AWS creates a DNS name baed on instance ID
This is helpfull because if the IP changes ,the resource based DNS name still work
Other AWS services (ALB,SSM,NAT,etc) can refference your instance directly 

>> Enable resource-based IPv6 (AAAA record ) DNS request 
   This is disabeled because
   *Your VPC or instances probably does not have IPv6 enabled
   *If you don't assign IPv6 ,you cannot create AAAA DNS record 

When enabled ,it would create DNS like 
i-0abcd1234efgh5678.ec2.internal → AAAA → IPv6 address

4.Instance Auto-Recovery [ Self healing of the hardware issue ,not creating new server = lift and shift ]
----------------------------------------------------------
Automatically recovers  the instance  if hardware  failure happens 
Means :
When the underlying physical host fails,AWS will move your Ec2 instance to healthy
hardware and restart it 

It  is the same instance :
*Public IP , Private IP , Elastic IP, Storage , Same Data
AWS basically "lift and shifts" server to a new physical machine 

This will not take place when : 
*OS crashes 
*If your application fails 
*If you shutdown the instance

When Auto-Recovery will trigger :
*CPU board failure
*Memory failure 
*Network card failure
*Hypervisor failure
*Power failure on host 

6.shutdown Behaviour 
-----------------------------------------------------------
It decides  what AWS should do when the operating system inside your Ec2 instance performs 
a shutdown 

For ex: 
>> sudo shutdown now
When you run this AWS will applies the setting :
either the 
               *  Stop 
               *  Terminate 

7.Stop-Hibernate Behaviour 
---------------------------------------------------------
When stopping the instance ,OS RAM will be saved to the disk 

Use cases: 
* Application that takes long time to initialize
* Instances that maintain in memory  state 

Require : 
*EBS backed instance
*Enough EBS size to store RAM 

8.Termination Protection 
----------------------------------------------------------
if enabeled ,the instance  can't be terminated usng the console ,API or CLI until 
termination  protection is disabled if no value is specified the value ofthe source 
template will be used , if the template value is not specified then the default API 
value  will be used 


9.Stop Protection 
--------------------------------------------------------
You can protect the instance from being accidentally stopped .Once enabled  you won't 
be able to stop this  instance via the API or the AWS management console until stop 
protection has been disabled 

10 . Detailed CloudWatch Monitoring 
------------------------------------------------------
Ec2 publishes  metrics  to CloudWatch every 5 minutes 
If you enable this option   the metric's will be sent to the CloudWatch every 1 minute 

Use this : 
If you want fast autoscaling 
You need detailed performace metrics
Extra charges will apply 

11. Credit specification 
--------------------------------------------------------
T-series instance are burstable instances  
*They run at low CPU most of the time     = Wher these instance earn CPU credit 
*They can burst to high CPU when needed   = Wher these instances speds CPU credits when it burts
When the credits becomes zero the instance will be throttled 

Here we will come across two option : 
Limited   ->   just use what you have earned when the cpu is idel and  slow  down when the credit become Zero 
Unlimited ->   instance can burst even when credits reach zero 

12. Placement Group 
--------------------------------------------------------
While creating Placement group you will have to follow these steps 
Step 1: Create a Placement Group
Step 2: Give it a name 
Step 3: Placement Strategy : Determines how the  instances are placed on the underlying  hardware 
         Choose Optoins like: 
         \_ Cluster
         \_ Spread    -> Select the spread level  -> choose either the Rack or Host 
         \_ Partition  ->  Select the Number of partitions  to be created in this placement group

Cluster Placement Group
>> AWS places all your Ec2 instances very close to each other  - Possilby on the same rack or the adjoining rack 
   Which provide 
  * Low network latency 
  * high network throughput 
  * Best for high performance computing 
  * Fast communication between the machine 

if something happens in that rack or on one network All instances may fail together ( Low fault tolerance)

Spread Placement Group
>> AWS places each instances in differenct racks with different power sources 
   Which provide 
   * Maximum fault tolerance
   * Each instance is isolated
   * No two instances share same hardware 

Used for: 
No high-speed networking performance
You can place max 7 instances per AZ

Partition Placement Group 
>> 
AWS divides your instances into partition ,each partition has:
*Different  racks
*Different  network
*Differenct power 
Inside the partition -> Machine may share the hardware 
Between the  partition  -> No shared hardware 


Which provide us with: 
*Very high fault tolerance
*Used for Big Data  systems
*Prevents data replication on same rack 

13.EBS-optimized Instance
-----------------------------------------------------
Enables additional ,dedicatted  throughPut between AMAZON  Ec2  AMAZON  EbS .Supported 
on cretain instance type only . Specifying an incompatible instance type will fail the 
instance launch

14.Instance bandwidth configuration 
-------------------------------------------------------
Allows you to override the default network bandwidth  (Supported in some instances)

Used when: 
*YOu need higher / lover bandwidth 
*You want predictabel burst behaviour 

15.Purchasing Option
------------------------------------------------------
Purchasing Options = How you want to pay for the Ec2 instance  and how AWS provide the capacity for you
There are 4 main options: 
1.None (On - Demand  -default)
2.Capacity Block 
3.Interruptible capacity block 
4.Spot instance

None : (On-Demand Instance)
This is the default 
*Pay per hour / second 
*No commitment 
*AWS gives you capacity  based on best effort
*Most flexible
*Most expensive

2.Capacity Blocks 
Thisis for high  performance  computing workload
*Buy a guaranteed Ec2 capacity for fixed time window 
*Exmaple: "I want 100 CPU hours between 10AM - 4PM on tuesday 
*You are guarenteededdddd to get those instances in the window
*Used for big research or simulation Jobs 

Not used by normal companies 

3.Interruptabel Capacity Reservation 
This means :
*YOu reserve Ec2 capacity 
*But AWs can take it away if needed
*You get discounts compared to normal reservation 
*Not as reliable  as Spot Instances

4.Spot instance 
This is one of the most important section 

Spot = spare  AWS capacity  sold at 70-90 discouts 
*Very cheap
*Same performance as On-Demand 
*Not Good for long-ruuning apps
*Can be interrupted at anytime 

YOu can customize the spot instance optoin like: 
MAXIMUM PRICE: Two_Choices
               \_ No maximum price [Request Spot Instances at the Spot price, capped at the On-Demand price]
                \_Set your maximum price (per instance /hour)
Request type: Two_Types
             \_One_time : AWS tries to lauch once .If the spot capacity is not available  -> request stops
              \_Persistent : if spot instances  get interrupted - AWS will automatically  retry lauching again ,useful for long bacth jobs 
Valid To: 
How long the spot instance request will be active:
*Default = NO expiry 
*YOu can set the data and time

Interruption behavviour 
What happens when the AWS need the capacity back ??
1.Stop
2.Hibernate 
3.Terminate 

16.Capacity Reservation 
-----------------------------------------------------------
CR means  AWS guaranteeing  that EC2 capacity will be availabel for you even when the region is busy 
Think of it like a  "boking the seats "in advance

1.Select
This just means : 
* AWS will automatically choose the best option 
* YOu don't force capacity reservation 
* You don't avoid it 

2.Open
Meaning: 
*Launch this instance in any existing capacity reservation 
* As long as the reservation matches instance type ,AZ and tenancy 

3.None:
Meaning: 
*Do not use any Capacity reservation 
*Treat this instance as normal On-Demand

This is the default for 99% of users 

4.Specify Capacity Reservation 
You already created a reservation earlier (manually)
Now you are telling the AWS
>> Launch this instance inside that specific reservation 
You must choose the reservatin ID
Used in large enterpriser for the production workload

5.Specify Capacity Reservation Resource Group 
A capacity reservation resource group contains mutliple capacitye reservation 
With this option,you tell the AWS :
“Launch this instance in ANY reservation inside this reservation group.”
Why is this useful?

Because companies create resource groups like:

*prod-east-app-group
*prod-east-database-group
*backup-cluster-group

Instead of selecting a single reservation, you target the group.
AWS will choose the best reservation from that group automatically.

7.Only Launch in a capacity reservation group
Similar to abouve ,but
 AWS must find a reservation inside the selected group
If not found, instance launch FAILS

| Option                               | Meaning                       | When Used                |
| ------------------------------------ | ----------------------------- | ------------------------ |
| **Select**                           | Let AWS decide                | Most users               |
| **Open**                             | Use any matching reservation  | Flexible enterprises     |
| **None**                             | Normal On-Demand              | Default                  |
| **Specify Reservation**              | Use exact reservation         | Strict control           |
| **Specify Resource Group**           | Use reservations inside group | Organized enterprises    |
| **Only launch in Reservation**       | Fail launch if no reservation | Critical apps            |
| **Only launch in Reservation Group** | Even stricter version         | Compliance/SLA workloads |

17.Tenancy
-------------------------------------------------------
Select the physical host  your instance runs on : 
Type: 
*Default : Shared hardware
*Dedicated Host: Entire  physical server for you only 
*Dedicated Instances: Runs on dedicated  hardware  but shared host 

18.Ram Disks
-------------------------------------------------------
Legacy options for the custom ram disks
Used for: 
*Ec2-classic era AMI
*Special boot environment 
YOu normally leave it as selecte

20.Kernal ID 
--------------------------------------------------------
Used for the custom linux kernal 
Deprecated 
Leave default

21.Nitro Enclave 
-------------------------------------------------------
Runs isolated secure enclaves[ super secure mini-computers ] inside an Ec2 instances
Used for : Handling sensitive data
           PCI workload
           encccrypted transaction 

22.User data (base64 encoded)
----------------------------------------------------------
User data runs scripts at boot
*Shell script
*cloud init
*Powershell command for the windows

AWS console encodes it automatically in Base64.

Ezmaple:
#!/bin/bash
yum update -y
yum install httpd -y
systemctl start httpd

23.License configuration 
----------------------------------------------------------
This setting lets you attach  software licencing rules to your Ec2 instance
AWS licence manager help companies manage costly liceses like:  

Microsoft Windows Server
SQL Server
Oracle Database
SAP
Red Hat Enterprise Linux
SUSE

Why is this useful??
1.Cost control
Avoid overusing expensive  licenses  (SQL Server license costs thousands).
2.Compliance
ensure every Ec2  instance follow licensing policies 
(prevent legal issues and audit)
3.Automated tracking 
Counts how maany licenses  each Ec2 is using 
4.BYOL (Bring your own license
Companies who own  software  licenses can  apply them to AWS 

Example
Your company has 20 SQL Server licenses.

➡ AWS License Manager blocks you from launching EC2 with SQL Server once you reach the limit
➡ Prevents accidental overspending

You can use the servies only if a licence exists  -either AWS provider it or your company providse it


Large companies run:

* 100s of Windows Server VMs
* 100 of SQL Server instances
* 10–50 Oracle DB machines
* Dozens of SAP systems

If licenses are not tracked:

* They might accidentally run more servers than licenses
* Result → legal issues, big audit fines, huge extra costs

AWS License Manager prevents that by:

* Blocking unauthorized launches
* Counting used licenses

Letting companies Bring Their Own License (BYOL)

24.Nested Virtualization
--------------------------------------------------------------------------
Nested virtualization means :
>> YOu can run a hypervisor inside your Ec2
>> That hypervisor  can run  virtual  machines inside your  Ec2 

EC2 → Hypervisor → Your own VMs


Supported instance types
Only metal instances (bare metal):

*i3.metal
*m5.metal
*c5.metal
*r5.metal
*c6.metal (newer)

Because they give you direct access to hardware.

Used for: 
*Running VMware labs
*Migrating on prem VM-ware to AWS
*Security testing 
*Network simulation 
*Building your own cloud platform 

CPU Options:
--------------------------------------------------------------------------
This lets you configure how many vCPU' and how many threads per core your Ec2.

You can modify : 
1.Number of vCPU'S 
Example: an m5.4xlarge normally has 16vCPUs
You can reduce it to 8 vCPU

2.Cores vs Threads
YOu can disable HypreThreading (Thread per core =1 instead of 2)

A thread  = a virtual execution pipeline inside a CPU core inside a CPU core 
* Each core can run programs 
* Each core may support Hyper-Threading or SMT
* Hyper-Threading allows 1 core to run 2 threads at the same time 

Simple explanation is : 
Think of it like a highway lane
* 1 thread  = 1 vehicle lane
* 2 thread  = 2 vehicle lane in the same physical space
So more vehicles (tasks) can move at the same time 


AWS defines:

1 thread = 1 vCPU
So if a core has 2 threads, that means 2 vCPUs.

Example (Intel Xeon / AMD EPYC):
>> 8 physical cores × 2 threads = 16 vCPUs

A thread is a virtual processing unit inside a core 
AWS counts each thread as one vCPU
So: 

More threads = more vCPU = more parallel tasks
Disabling threads = fewer vCPU but more stable per core performance 

When to disable HyperThreading 
You should disable the Hyperthreading when you need consistent , predictabel
core performance

Use cases where HT  should be Disabled:
1.Databases
2.High performance computing
3.Real time or latency-sensitive  workloads
4.Licensing Based on Physical cores

When not to disable the HyperThreading :
* When you run the microService
* Java apps/ Node.js apps
* Web server
* API servers
* CI/CD  agents
* General workloads

HT gives you 30–40% more throughput with the same price.


✔ Why companies use this?
1️⃣ Reduce Licensing Cost (VERY IMPORTANT)
Oracle and SQL Server license by:
➡ CPU cores
➡ Sockets

If you reduce vCPUs:
You pay WAY LESS.

Example:
SQL Server Enterprise = $14,000 per core.

If you reduce from 8 cores → 4 cores:
You save ★ $56,000 ★
(This is EXACTLY why companies use CPU options.)

2️⃣ Performance Tuning
Some workloads RUN BETTER without HyperThreading:

* HPC (High Performance Computing)
* Financial algorithms
* Real-time systems
* Gaming servers

3️⃣ Reduce noisy neighbor effect
Fewer vCPUs = predictable performance.

MetaData Accessible
---------------------------------------------------------------------------
This controls whether application inside your Ec2 instance can read instance 
metadata from :
http://169.254.169.254/latest/meta-data

If :
Enabeled>>
You application can read: 
*Instance ID
*Private/Public IP
*IAM Role Credentials
*Security group info
*Tags (If allowed)

This is required for:
*Using Instance Profile IAM role
* Auto-Scaling agent
*Clound-watch agent
*SSM agent 

Disabled :
YOu Ec2 instance canot read metadata

Used in:
*Highly secure environment 
*Workload where IAM cred must never be leaked 
*Host exposed to untrusted workloads

25. Metadata Version 
----------------------------------------------------------------------------
AWS supports IMDSv1 and IMDSv2 

IMDSv2 (recommended and used by default)
Require a token for every metadata request

This protects against SSRF attacks (Server side request forgery )
Meaning : a vulnerable web app cannot be tricked into exposing IAM credentials 

26.Metadata Hop Limit
--------------------------------------------------------------------------
Controls how many network hops a metadata request can travel
Default =1 ,which means 
*Only application inside the Ec2  instance can reach metadata

Why this matters??
If set>1:
*Containers 
*Proxies 
*Nested networking 
inside your Ec2 instance might  be able to read the metadata

Best Practices:
Set hop limit = 1 unless you are using:
* Kubernetes on Ec2
* Docker containers that need role credentials 


27.Allow tags in Metadata
---------------------------------------------------------------------------
This options decides whether your Ec2 instance can read its own tags through metadata
Example: 
Name = web-server-1
Environment = prod
Owner = devops-team

Benefit : 
YOur app doesnot need AWS API permission to read these tags
Example use cases:
*Agents auto-configuring based on env
*Logging systems adding instances metadata
*Apps  that use tags to select configuration 

AWS metadata URL for tags:
>> http://169.254.169.254/latest/meta-data/tags/instance
